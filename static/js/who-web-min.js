WHOAT.web=function(e,t,n){"use strict";function i(){var t=location.pathname;s(t);e(".whoat_logo").unbind("click").bind("click",function(){WHOAT.networking.redirectToURL("/home")})}function s(t){var n;t=t.split("/");switch(t[1]){case"home":o();break;case"login":n=e(".register_box").data("tab-type");a(n);break;case"register":n=e(".register_box").data("tab-type");a(n);break;case"about":o();break;case"faq":o();f();break;case"forgot":WHOAT.credentials.forgotPassword();break;case"resetpassword":WHOAT.credentials.resetPassword()}}var r=!1,o=function(){function n(){e(".error_home_username span").text(" ");e(".error_home_username").hide();e(".error_home_password span").text(" ");e(".error_home_password").hide()}var t;e("#open_login").unbind("click").bind("click",function(){e(".home_login_box").slideToggle("fast")});e(".gradient").unbind("click").bind("click",function(){e(".home_login_box").fadeOut("fast");window.clearTimeout(t);if(r===!0){e(".pdf_menu").css("left","0px");e(".gradient").css("margin-top","-71px");e("#pdf_dropdown").hide();r=!1}});e("#getting_started_guide").unbind("click").bind("click",function(){if(r===!1){e("#pdf_dropdown").fadeIn("fast");r=!0}else{e("#pdf_dropdown").hide();r=!1}});e("#home_login").unbind("submit").bind("submit",function(){n();var t={username:"",password:""},r=e("#home_login_submit");e(r).css("cursor","auto");e(r).css("background","#004e84");e(r).css("font-size","13px");e(r).text("logging...");e(r).attr("disabled","true");var i=window.location.pathname,s=window.location.href.split("?"),o=s[1];t.username=e("#home_login_email").val();t.password=e("#home_login_password").val();WHOAT.networking.postToServerWithAjax("/login",t,function(t){if(t.result==="success"){e("#home_login_email").css("border","2px solid #E8E8E8");e("#home_login_password").css("border","2px solid #E8E8E8");WHOAT.networking.redirectToURL("/dashboard")}else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).css("font-size","16px");e(r).text("login");e(r).css("background","#006497");e(r).css("cursor","pointer");var n=t.message;if(n==="Username not registered"){e(".error_home_username span").text(n);e(".error_home_username").show()}else if(n==="Invalid password"){e(".error_home_password span").text(n);e(".error_home_password").show()}else{e(".error_home_username span").text(n);e(".error_home_username").show()}}});return!1});e(".close_errs").unbind("click").bind("click",function(){n()});e(".home_login_input").focus(function(){n()});e(".learn_more").unbind("click").bind("click",function(){WHOAT.analytics.trackClickEvent("Learn More");e("html, body").animate({scrollTop:e("#intro_app_area").offset().top},1e3)});e(".go_appstore").unbind("click").bind("click",function(){var t=e(this),n=t.data("id");WHOAT.analytics.trackClickEvent("iPhone App Store");WHOAT.networking.redirectToURL("https://itunes.apple.com/us/app/who-intro/id"+n,"_blank")});e(".arrow_to_namegame").unbind("click").bind("click",function(){e("html, body").animate({scrollTop:e("#namegame_area").offset().top},1e3)});var i=e(".see_it_works");i.length&&i.modal&&i.modal({trigger:".see_it_works",olay:"div.overlay",modals:"div.video_holder",animationEffect:"fadeIn",animationSpeed:400,moveModalSpeed:"slow",background:"000",opacity:.8,openOnLoad:!1,docClose:!0,closeByEscape:!0,moveOnScroll:!0,resizeWindow:!0,video:"https://player.vimeo.com/video/84403777?autoplay=1",videoClass:"video",close:".big_x"})},u=function(){},a=function(t){e(".login_unselected").unbind("click").bind("click",function(){r("login")});e(".register_unselected").unbind("click").bind("click",function(){r("register")});var r=function(t){if(t==="register"){e("#login_form").hide();e("#register_form").show();e(".on_login_tab").hide();e(".on_register_tab").show()}else if(t==="login"){e("#register_form").hide();e("#login_form").show();e(".on_login_tab").show();e(".on_register_tab").hide()}};r(t);e("#login_form").unbind("submit").bind("submit",function(){var t={username:"",password:""},r=e("#login_page_submit");e(r).css("cursor","auto");e(r).css("background","#ccc");e(r).text("logging...");e(r).attr("disabled","true");var i=window.location.href.split("?"),s=i[1];if(s!==n&&s.toLowerCase().indexOf("bounce=")>=0){s=s.replace("bounce=","");t.bounce=s}t.username=e("#login_input_email").val();t.password=e("#login_input_password").val();WHOAT.networking.postToServerWithAjax("/login",t,function(t){if(t.result==="success")WHOAT.networking.redirectToURL("/dashboard");else if(t.result==="bounce")WHOAT.networking.redirectToURL(t.message);else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).text("login");e(r).css("background","#f58733");e(r).css("cursor","pointer");var n=t.message;if(n!=="Username not registered")if(n==="Invalid password"){e(".error_password_span").text(n);e("#error_login_password").show()}else{e(".error_email_span").text(n);e("#error_login_email").show()}}});return!1});e("#register_form").unbind("submit").bind("submit",function(t){WHOAT.validation.validateRegisterForm("#register_form");var r=e("#the_register_button");e(r).css("cursor","auto");e(r).css("background","#ccc");e(r).text("registering...");e(r).attr("disabled","true");var i={username:"",firstName:"",lastName:"",password:"",register_source:"",register_original:""};i.username=e("#register_email").val();i.firstName=e("#register_firstname").val();i.lastName=e("#register_lastname").val();i.password=e("#register_password").val();i.register_original=e("#register_original").val();i.register_source=e("#register_source").val();WHOAT.networking.postToServerWithAjax("/register",i,function(t){if(t.result==="success"){e(r).text("register");e(r).css("background","#f58733");i.register_original===n||i.register_original===""?window.location="/register/success":window.location="/auto/verify"}else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).css("background","#f58733");e(r).css("cursor","pointer");e("#register_input_error").fadeIn("fast",function(){var n=!0,r=e("#register_input_error");e("#input_error_message").text(t.message);r.show();r.click(function(){e("#register_input_error").hide();n=!1});n&&setTimeout(function(){e(this).fadeOut("slow",function(){n=!1})},5e3)})}});return!1});e(".x").unbind("click").bind("click",function(){var t=e(this),n=t.parent("div").attr("id");t.parent("div").hide();n==="error_login_email"?e("#login_input_email").css("border","2px solid #E8E8E8"):n==="error_login_password"&&e("#password").css("border","2px solid #E8E8E8")})},f=function(){e("#faq_page .open_guides").unbind("click").bind("click",function(){e("#faq_page").animate({scrollTop:e("#header").offset().top},500);e(".pdf_menu").css("left","79px");e("#pdf_dropdown").fadeIn("fast");r=!0})};return{init:i,wireHomePage:o,wireAboutPage:u,wireLoginRegister:a,wireFAQ:f}}(jQuery,window);$(document).ready(function(){WHOAT.web.init()});
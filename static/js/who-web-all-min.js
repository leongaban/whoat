window.Modernizr=function(e,t,n){function r(e){d.cssText=e}function i(e,t){return r(g.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}var a="2.6.2",f={},l=!0,c=t.documentElement,h="modernizr",p=t.createElement(h),d=p.style,v,m={}.toString,g=" -webkit- -moz- -o- -ms- ".split(" "),y={},b={},w={},E=[],S=E.slice,x,T=function(e,n,r,i){var s,o,u,a,f=t.createElement("div"),l=t.body,p=l||t.createElement("body");if(parseInt(r,10))while(r--)u=t.createElement("div"),u.id=i?i[r]:h+(r+1),f.appendChild(u);return s=["&#173;",'<style id="s',h,'">',e,"</style>"].join(""),f.id=h,(l?f:p).innerHTML+=s,p.appendChild(f),l||(p.style.background="",p.style.overflow="hidden",a=c.style.overflow,c.style.overflow="hidden",c.appendChild(p)),o=n(f,e),l?f.parentNode.removeChild(f):(p.parentNode.removeChild(p),c.style.overflow=a),!!o},N={}.hasOwnProperty,C;!s(N,"undefined")&&!s(N.call,"undefined")?C=function(e,t){return N.call(e,t)}:C=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=S.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(S.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(S.call(arguments)))};return r}),y.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:T(["@media (",g.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n};for(var k in y)C(y,k)&&(x=k.toLowerCase(),f[x]=y[k](),E.push((f[x]?"":"no-")+x));return f.addTest=function(e,t){if(typeof e=="object")for(var r in e)C(e,r)&&f.addTest(r,e[r]);else{e=e.toLowerCase();if(f[e]!==n)return f;t=typeof t=="function"?t():t,typeof l!="undefined"&&l&&(c.className+=" "+(t?"":"no-")+e),f[e]=t}return f},r(""),p=v=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function i(e){var t=v[e[p]];return t||(t={},d++,e[p]=d,v[d]=t),t}function s(e,n,r){n||(n=t);if(m)return n.createElement(e);r||(r=i(n));var s;return r.cache[e]?s=r.cache[e].cloneNode():c.test(e)?s=(r.cache[e]=r.createElem(e)).cloneNode():s=r.createElem(e),s.canHaveChildren&&!l.test(e)?r.frag.appendChild(s):s}function o(e,n){e||(e=t);if(m)return e.createDocumentFragment();n=n||i(e);var s=n.frag.cloneNode(),o=0,u=r(),a=u.length;for(;o<a;o++)s.createElement(u[o]);return s}function u(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function a(e){e||(e=t);var r=i(e);return g.shivCSS&&!h&&!r.hasCSS&&(r.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),m||u(e,r),e}var f=e.html5||{},l=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h,p="_html5shiv",d=0,v={},m;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",h="hidden"in e,m=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){h=!0,m=!0}})();var g={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:m,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:a,createElement:s,createDocumentFragment:o};e.html5=g,a(t)}(this,t),f._version=a,f._prefixes=g,f.testStyles=T,c.className=c.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(l?" js "+E.join(" "):""),f}(this,this.document),function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c=t.createElement(e),d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[]),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,u){var a=t(e),f=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]),a.instead?a.instead(e,i,s,o,u):(T[a.url]?a.noexec=!0:T[a.url]=1,s.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":n,a.noexec,a.attrs,a.timeout),(r(i)||r(f))&&s.load(function(){l(),i&&i(a.origUrl,u,o),f&&f(a.origUrl,u,o),T[a.url]=2})))}function u(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var a,f,c=this.yepnope.loader;if(i(e))o(e,0,c,0);else if(S(e))for(a=0;a<e.length;a++)f=e[a],i(f)?o(f,0,c,0):S(f)?k(f):Object(f)===f&&u(f,c);else Object(e)===e&&u(e,c)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};(function(e){e.fn.modal=function(t){function n(){e("."+t.videoClass).attr("src",t.video);o.hide();u.css({top:e(window).height()/2-u.outerHeight()/2+e(window).scrollTop(),left:e(window).width()/2-u.outerWidth()/2+e(window).scrollLeft()});if(a===!1){s.css({opacity:t.opacity,backgroundColor:"#"+t.background});s[t.animationEffect](t.animationSpeed);u.delay(t.animationSpeed)[t.animationEffect](t.animationSpeed)}else u.show();a=!0}function r(){o.stop(!0).animate({top:e(window).height()/2-o.outerHeight()/2+e(window).scrollTop(),left:e(window).width()/2-o.outerWidth()/2+e(window).scrollLeft()},t.moveModalSpeed)}function i(){e("."+t.videoClass).attr("src","");a=!1;o.fadeOut(100,function(){t.animationEffect==="slideDown"?s.slideUp():t.animationEffect==="fadeIn"&&s.fadeOut()});return!1}t=e.extend({trigger:".see_it_works",olay:"div.overlay",modals:"div.video_holder",animationEffect:"fadeIn",animationSpeed:400,moveModalSpeed:"slow",background:"000",opacity:.8,openOnLoad:!1,docClose:!0,closeByEscape:!0,moveOnScroll:!0,resizeWindow:!0,video:"",videoClass:"video",close:".closeBtn"},t);var s=e(t.olay),o=e(t.modals),u,a=!1;t.animationEffect==="fadein"&&(t.animationEffect="fadeIn");t.animationEffect==="slidedown"&&(t.animationEffect="slideDown");s.css({opacity:0});if(t.openOnLoad)n();else{s.hide();o.hide()}e(t.trigger).bind("click",function(t){t.preventDefault();if(e(".see_it_works").length>1){getModal=e(this).attr("href");u=e(getModal)}else u=e(".video_holder");n()});t.docClose&&s.bind("click",i);e(t.close).bind("click",i);t.closeByEscape&&e(window).bind("keyup",function(e){e.which===27&&i()});if(!t.resizeWindow)return!1;e(window).bind("resize",r);if(!t.moveOnScroll)return!1;e(window).bind("scroll",r)}})(jQuery);var WHOAT=WHOAT||{};WHOAT.base=function(e,t,n){"use strict";return{}}(jQuery,window);var _gaq=_gaq||[];_gaq.lang="en";_gaq.push(["_setAccount","UA-28028192-1"]);_gaq.push(["_setDomainName","whoat.net"]);_gaq.push(["_setAllowLinker",!1]);_gaq.push(["_gat._anonymizeIp"]);_gaq.push(["_trackPageview"]);WHOAT.analytics=function(e,t,n){"use strict";function r(){(function(){var e=document.createElement("script");e.type="text/javascript";var t=document.getElementsByTagName("script")[0];e.async=!0;e.src=("https:"==document.location.protocol?"https://ssl":"https://www")+".google-analytics.com/ga.js";t.parentNode.insertBefore(e,t)})()}var i=function(e){if(e===null||e===n)e=t.location.pathname;e=e.replace(new RegExp(/\/[0-9]+$/),"/details");_gaq.push(["_trackPageview",e])},s=function(e){var n=t.location.pathname;n=n.replace(new RegExp(/\/[0-9]+$/),"/details");_gaq.push(["_trackEvent","click",e,"url for clicked is "+n])},o=function(e){var n=t.location.pathname;n=n.replace(new RegExp(/\/[0-9]+$/),"/details");_gaq.push(["_trackEvent","search",e,"url for search is "+n])},u=function(e,t,r){var i;r!==null&&r!==n?i="video id is "+t+" and time is "+r:i="video id is "+t;_gaq.push(["_trackEvent","video",e,i])};i();return{trackPageView:i,trackClickEvent:s,trackSearchEvent:o,trackVideoEvent:u,init:r}}(jQuery,window);$(document).ready(function(){WHOAT.analytics.init()});WHOAT.credentials=function(e,t,n){"use strict";function r(){}var i=function(){e(".close_error").unbind("click").bind("click",function(){e("#forgot_password_error").hide();e("#forgot_password").css("top","30px")});e("#forgot-form").unbind("submit").bind("submit",function(){function s(){e(i).text("submit");e(i).removeAttr("disabled");e(i).css("background","#f58733");e(i).css("cursor","pointer")}var t=e("#reset_email").val(),n={reset_email:t},r,i=e("#btn_forgot_password");e(i).css("cursor","auto");e(i).css("background","#ccc");e(i).text("submitting...");e(i).attr("disabled","true");var o=function(t,n){e(".forgot_password_error_msg").empty();e(".forgot_password_error_msg").text(r);t==="success"&&e("#forgot_password_error").css("background","#006497");e("#forgot_password").css("top","-35px");e("#forgot_password_error").fadeIn("fast")};WHOAT.networking.postToServerWithAjax("/forgot/password",n,function(t){if(t.result=="success"){e("#forgot_password_error").is(":visible")&&e("#forgot_password_error").hide();r=t.message;o("success",r);s()}else if(t.result=="error"){r=t.message;o("error",r);s()}});return!1})},s=function(){e(".close_error").unbind("click").bind("click",function(){e("#forgot_password_error").hide();e("#reset_password").css("top","30px")});var t=function(t){e(t).text("submit");e(t).removeAttr("disabled");e(t).css("cursor","pointer");e(t).css("background","#f58733")},n=function(t,n){e(".forgot_password_error_msg").empty();e(".forgot_password_error_msg").text(n);e("#reset_password").css("top","-35px");e("#forgot_password_error").css("height","60px");e("#forgot_password_error").css("line-height","28px");e("#forgot_password_error").css("padding-top","10px");if(t==="success"){e("#forgot_password_error").css("background","#006497");e("#forgot_password_error").fadeIn("fast",function(){setTimeout(function(){window.location="/login"},4e3)})}else e("#forgot_password_error").fadeIn("fast")};e("#reset_password").unbind("submit").bind("submit",function(r){var i=e("#submit-to-reset");e(i).css("cursor","auto");e(i).css("background","#ccc");e(i).text("Resetting Password...");e(i).attr("disabled","true");if(WHOAT.validation.validateForgotPasswordForm("#reset-form")===!0){var s=e("#reset-password-input").val(),o=e("#reset-password-input2").val(),u=document.URL,a=u.split("hotlink="),f=a[1],l,c={resetPass1:s,resetPass2:o,hotlink:f};WHOAT.networking.postToServerWithAjax("/resetpassword",c,function(r){if(r.result=="success"){t("#submit-to-reset");e("#forgot_password_error").is(":visible")&&e("#forgot_password_error").hide();l=r.message;n("success",l);e("#forgot_password_error").fadeIn("fast",function(){setTimeout(function(){window.location="/login"},4e3)})}else if(r.result=="error"){t("#submit-to-reset");if(r.message_expired){l=r.message_expired;n("error",l)}else if(r.message){l=r.message;n("error",l)}e("#forgot_password_error").fadeIn("fast")}})}else t("#submit-to-reset");return!1});return{displayMessage:n}};return{forgotPassword:i,resetPassword:s,init:r}}(jQuery,window);$(document).ready(function(){WHOAT.credentials.init()});WHOAT.events=function(e,t,n){"use strict";function r(t){var r=JSON.parse(t),i=r.result==="success",s=e("<div>"),o;i?s.addClass("alert alert-success"):s.addClass("alert alert-error");r.message!==n?o=r.message:i?o="Success":o="There was an error. Please try again later.";s.html(e("<h4>").html(o));s.hide();s.appendTo(".notification-container");s.show("slow");return s}function i(t){var n=r(t);setTimeout(function(){e(n).slideUp("slow",function(){e(n).remove()})},5e3)}function s(t){var n=e("tr[data-message-id='"+t+"']");n&&n.remove()}function o(t){var n=e("tr[data-message-id='"+t+"']"),r;if(n){r=n.find("td:first");r.removeClass("pending-cell");r.addClass("accepted-cell");r.find("p").html("Accepted")}}function u(t){var n=e(t),r=n.find("td:first");n.hasClass("unread-row")&&n.removeClass("unread-row");if(r.hasClass("unread-cell")){r.removeClass("unread-cell");r.addClass("pending-cell");r.html("");r.append("<div><span></span></div>");r.append("<p>Pending</p>")}}var a=function(t){var n=e(t);n.unbind("submit").bind("submit",function(){WHOAT.validation.validateLoginForm(this)&&WHOAT.networking.postToServerWithForm(this);return!1});n.find("input[name='password']").unbind("keyup").bind("keyup",function(e){e.keyCode===13&&n.find("button").click()})},f=function(t,n){var r=e(t);r.unbind("click").bind("click",function(){WHOAT.animations.animateLoginContainer(n)})},l=function(t,n){var r=e(t);r.unbind("click").bind("click",function(){WHOAT.networking.postToServer("/logout")})},c=function(t){var n=e(t);n.find("input[name='register_password']").unbind("keyup").bind("keyup",function(e){e.keyCode===13&&this.find("button").click()})},h=function(){var t=e("#register-email").val();e("#body-login .login-logo img").animate({top:"-=15"},1e3,function(){});e("#alert-user-email").text(t);e("#body-login .login-logo p").fadeIn("slow");e("#register-form").hide();e("#form-background").animate({height:273},200);e("#login-form").fadeToggle();e(".login-unselected").removeClass("login-unselected").addClass("login-selected");e(".login-selected").parent().find("#tab-register").removeClass("register-selected").addClass("register-unselected")},p=function(t){var n=e(t);n.unbind("submit").bind("submit",function(){WHOAT.validation.validateSendForgotPasswordForm(n);return!1});n.find("input[name='email']").unbind("keyup").bind("keyup",function(e){e.keyCode===13&&n.find("button").click()})},d=function(n){var r=e(n);r.find("a").unbind("click").bind("click",function(){WHOAT.networking.redirectToURL("/login")});r.unbind("submit").bind("submit",function(){if(WHOAT.validation.validateForgotPasswordForm(this)){var n=t.location.search;e(this).attr("action",e(this).attr("action")+n);WHOAT.networking.postToServerWithForm(this)}return!1});r.find("input[name='email']").unbind("keyup").bind("keyup",function(e){e.keyCode===13&&r.find("button").click()})},v=function(t,n){var r=e(t),i=!1;r.find("> tr:not(.footable-row-detail) td").unbind("click").bind("click",function(t){var s=e(this),o=e(this).parents("tr:first");if(i)return;i=!0;if(s.index()===0&&r.is(".breakpoint"))return;var a=o.data("message-id"),f="",l;n===WHOAT.enums.tableEnum.INCOMING?f="/incoming/"+a:n===WHOAT.enums.tableEnum.MY_REQUESTS&&(f="/myrequests/"+a);l={id:a};WHOAT.networking.postToServerWithAjax(f,l,function(t){WHOAT.animations.pushAndHideContent(t,e("#dashboard-body"));i=!1;u(o)})})},m=function(t,n){var r=e(t);r.find("tr button").unbind("click").bind("click",function(t){var n=e(this).parents("tr:first").data("user-details"),r=e("#contactModal"),s=e("#tmpl-contact-details").html(),o=e("#tmpl-intro-request").html(),u,a,f,l;if(n.userNetworks.inPersonal===0){e("#contactDetails").hide();r.find(".close:last").show()}else{u=Handlebars.compile(s);a=u(n);f=e("#contactDetails").find(".modal-body");f.empty();e(a).appendTo(f);f.find(".close:last").hide();e("#contactDetails").show()}if(n.userNetworks.inGroup>0||n.userNetworks.inOrganization>0||n.userNetworks.inFriends>0){u=Handlebars.compile(o);a=u(n);l=e("#requestIntro").find(".modal-body");l.empty();e(a).appendTo(l);e("#requestIntro").show()}else e("#requestIntro").hide();r.modal("show");r.find(".btn-primary").unbind("click").bind("click",function(){e(this).button("loading");var t=r.find("textarea"),s=t.val(),o=n.guid,u=[],a;s===""&&(s=t.attr("placeholder"));for(var f=0;f<n.networks.length;f++)u[f]=n.networks[f].guid;a={message:s,networks:u,target:o};WHOAT.networking.postToServerWithAjax("/createrequest",a,function(e){r.modal("hide");i(e);r.find(".btn-primary").button("reset")})})})},g=function(t){var n=e(t),r=n.find(".accept-decline-select-container"),u=n.find(".accept-decline-reply-container:first"),a=n.find(".accept-decline-reply-container:last"),f=r.find(".btn-accept"),l=r.find(".btn-decline"),c=n.find(".dashboard-message-details-response-container");f.unbind("click").bind("click",function(){r.fadeOut("normal",function(){u.fadeIn("normal")})});l.unbind("click").bind("click",function(){r.fadeOut("normal",function(){a.fadeIn("normal")})});c.find(".accept-decline-reply-container a").unbind("click").bind("click",function(){e.when(c.find(".accept-decline-reply-container").fadeOut("normal")).done(function(){r.fadeIn("normal")});return!1});u.find('form[name="acceptForm"]').unbind("submit").bind("submit",function(){var e=u.find("textarea").val();e==""?e=u.find("textarea").attr("placeholder"):e=WHOAT.utility.trimFromBeginningAndEnd(e);var t=n.data("message-id"),r={message:e,id:t},s="/incoming/"+t+"/accept";WHOAT.networking.postToServerWithAjax(s,r,function(e){i(e);o(t);n.find(".btn-back").click()});return!1});a.find('form[name="declineForm"]').unbind("submit").bind("submit",function(){var e=a.find("textarea").val();e&&e!==""&&(e=WHOAT.utility.trimFromBeginningAndEnd(e));var t=n.data("message-id"),r={message:e,id:t},o="/incoming/"+t+"/decline";WHOAT.networking.postToServerWithAjax(o,r,function(e){i(e);s(t);n.find(".btn-back").click()});return!1})},y=function(t){var n=e(t);n.find(".last-child a:last").unbind("click").bind("click",function(){var e=n.data("message-id"),t={id:e},r="/myrequests/"+e+"/delete";WHOAT.networking.postToServerWithAjax(r,t,function(t){i(t);s(e);n.find(".btn-back").click()});return!1})},b=function(t,n){e(t).unbind("click").bind("click",function(){if(e(n).find("> div:hidden").length>0){WHOAT.animations.popAndPushContent(n);return!1}WHOAT.networking.redirectToURL(e(this).attr("href"))})},w=function(t){var n=e(t);setTimeout(function(){n.slideUp("slow",function(){n.html("")})},5e3)},E=function(n){var r=e(n),i=t.location.pathname.replace(new RegExp("//[0-9]+/"),""),s=new RegExp(i.replace(/\/$/,""));r.find("a").each(function(){s.test(this.href.replace(/\/$/,""))&&e(this).addClass("active")})},S=function(t){var n=e(t);n.find("a").unbind("click").bind("click",function(){e(".popover").remove()})};return{wireLoginForm:a,wireMultipleForms:S,wireDashboardNav:E,wireNotificationContainer:w,wireBackButtonToPopContents:b,wireMyRequestDetailsForm:y,wireIncomingDetailsForm:g,wireSearchTableBody:m,wireMessageTableBody:v,wireResetPasswordForm:d,wireSendPasswordResetForm:p,wireRegisterForm:c,wireLogoutButton:l,wireLoginButton:f}}(jQuery,window);WHOAT.networking=function(e,t,n){"use strict";var r=function(e,t,n,r){WHOAT.analytics.trackPageView(e);jQuery.ajax({type:r,url:e,cache:!1,data:t,statusCode:{200:function(e,t,r){n(e)},201:function(e,t,r){n(e)},400:function(e,t,r){n(e)}}})},i=function(t,n,r,i){WHOAT.analytics.trackPageView(t);e.ajax({type:i,url:t,cache:!1,data:JSON.stringify({params:n}),contentType:"application/json",statusCode:{200:function(e,t,n){r(e)},201:function(e,t,n){r(e)},400:function(e,t,n){r(e)}}})},s=function(e,t,n){r(e,t,n,"POST")},o=function(e,t,n){i(e,t,n,"POST")},u=function(e,t,n){r(e,t,n,"GET")},a=function(t){var n=e(t),r=n.attr("action");WHOAT.analytics.trackPageView(r);n.unbind("submit");n.submit()},f=function(t,n){WHOAT.analytics.trackPageView(t);var r=e('<form id="mapform" action="'+t+'" method="post"></form>');for(var i in n)n.hasOwnProperty(i)&&r.append('<input type="hidden" name="'+i+'" id="'+i+'" value="'+n[i]+'" />');e("body").append(r);r.submit()},l=function(e,t){t=t||"_self";WHOAT.analytics.trackPageView(e);t==="_blank"?window.open(e):window.location=e};return{postToServerWithAjax:s,postToServerWithAjaxJSON:o,postToServerWithForm:a,getToServerWithAjax:u,postToServer:f,redirectToURL:l}}(jQuery,window);WHOAT.validation=function(e,t,n){"use strict";function f(e){var t=e.split(".");return t[t.length-1]}function l(t,n,r){var i=e(n);i.data({content:r});switch(t){case"login-email-required":e("#msg-username span").text(r);e("#msg-username").fadeIn("fast");e(".tip-msg").css("text-indent","-134px");break;case"login-email-invalid":e("#msg-username span").text(r);e("#msg-username").fadeIn("fast");e("#error-email span").text(r);e("#error-email").fadeIn("fast");break;case"login2-password-required":e("#error-password span").text(r);e("#error-password").fadeIn("fast");break;case"login2-password-invalid":e("#error-password span").text(r);e("#error-password").fadeIn("fast");break;case"login2-password":e("#error-password span").text(r);e("#error-password").fadeOut("fast");break;case"login-password-required":e("#msg-password span").text(r);e("#msg-password").fadeIn("fast");e(".tip-msg2").css("text-indent","-163px");break;case"login-password-invalid":e("#msg-password span").text(r);e("#msg-password").fadeIn("fast");e(".tip-msg2").css("text-indent","-172px");break;case"email":e("#register-form #register-error-email span").text(r);e("#register-form #register-error-email").fadeIn("fast");break;case"firstname":e("#register-form #error-first-name span").text(r);e("#register-form #error-first-name").fadeIn("fast");break;case"lastname":e("#register-form #error-last-name span").text(r);e("#register-form #error-last-name").fadeIn("fast");break;case"password":e("#register-form #register-error-password span").text(r);e("#register-form #register-error-password").fadeIn("fast");break;case"reset-pass":WHOAT.credentials.resetPassword().displayMessage("error","Password is required");break;case"reset-6":WHOAT.credentials.resetPassword().displayMessage("error","Must be at least 6 characters");break;case"reset-match":WHOAT.credentials.resetPassword().displayMessage("error","Passwords must match")}}var r=/[A-Za-z]/,i=/[0-9{7,}]/,s=/^..*[@]..*[.]..*$/,o={placement:"right",animation:!1,esc_close:0,trigger:"manual"},u=!1,a=!1,c=function(e){var t=f(e);switch(t.toLowerCase()){case"vcf":case"json":case"csv":return!0}return!1},h=function(e){return s.test(e)===!0},p=function(e){return r.test(e)===!1&&phoneRegex.test(e)===!0},d=function(e){return e.length===0},v=function(t,n){var r=e(n),i=r.find("input[name='username']"),s=r.find("input[name='password']"),o=!0;if(d(i.val())===!0){l("login-email-required",i,"Username not registered");i.css("border-color","#f58733");o=!1}else if(h(i.val())===!1){l("login-email-invalid",i,"Please use a valid email");i.css("border-color","#f58733");o=!1}else h(i.val())===!0;if(t==="home_login"){if(d(s.val())===!0){l("login-password-required",s,"Password is required");o=!1}else if(s.val().length<6){l("login-password-invalid",s,"6 characters minimum");s.css("border-color","#f58733");o=!1}}else if(t==="/login")if(d(s.val())===!0){l("login2-password-required",s,"Password is required");s.css("border-color","#f58733");o=!1}else if(s.val().length<6){l("login2-password-invalid",s,"6 characters minimum");s.css("border-color","#f58733");o=!1}else if(s.val().length>=6){l("login2-password",s,"");o=!1}return o},m=function(t){var n=e(t),r=n.find("input[name='register_email']"),i=n.find("input[name='register_first_name']"),s=n.find("input[name='register_last_name']"),o=n.find("input[name='register_password']"),u=!0;if(d(r.val())===!0){l("email",r,"Email is required");u=!1}else if(h(r.val())===!1){l("email",r,"A valid email is required");u=!1}if(d(i.val())===!0){l("firstname",i,"First name is requrired");u=!1}if(d(s.val())===!0){l("lastname",s,"Last name is requrired");u=!1}if(d(o.val())===!0){l("password",o,"Password is requrired");u=!1}else if(o.val().length<6){l("password",o,"Minimum 6 Characters");u=!1}else if(o.val().length>=6){l("password",o,"");e(".tip-register_password").hide();u=!1}return u},g=function(t){var n=e(t),r=n.find("input[name='email']"),i=!0;if(d(r.val())===!0){l(r,"Email is required");i=!1}else if(h(r.val())===!1){l(r,"Invalid email");i=!1}return i},y=function(t){var n=e(t),r=n.find("input[name='resetPass1']"),i=n.find("input[name='resetPass2']"),s=!0;if(d(r.val())===!0){l("reset-pass",null,"Password is requrired");s=!1}else if(r.val().length<6){l("reset-6",null,"Must be at least 6 characters");s=!1}if(d(i.val())===!0){l("reset-pass",null,"Password is requrired");s=!1}else if(i.val().length<6){l("reset-6",null,"Must be at least 6 characters");s=!1}if(r.val()!==i.val()){l("reset-match",null,"Passwords must match");s=!1}return s};return{isValidContactSource:c,isValidEmail:h,isValidPhone:p,isBlank:d,validateLoginForm:v,validateRegisterForm:m,validateSendForgotPasswordForm:g,validateForgotPasswordForm:y}}(jQuery,window);WHOAT.web=function(e,t,n){"use strict";function i(){var e=location.pathname;s(e)}function s(t){var n;t=t.split("/");switch(t[1]){case"home":o();break;case"login":n=e(".register_box").data("tab-type");u(n);break;case"register":n=e(".register_box").data("tab-type");u(n);break;case"about":o();break;case"faq":o();a();break;case"forgot":WHOAT.credentials.forgotPassword();break;case"resetpassword":WHOAT.credentials.resetPassword()}}var r=!1,o=function(){function n(){e(".error_home_username span").text(" ");e(".error_home_username").hide();e(".error_home_password span").text(" ");e(".error_home_password").hide()}var t;e("#open_login").unbind("click").bind("click",function(){e(".home_login_box").slideToggle("fast")});e(".gradient").unbind("click").bind("click",function(){e(".home_login_box").fadeOut("fast");window.clearTimeout(t);if(r===!0){e(".pdf_menu").css("left","0px");e(".gradient").css("margin-top","-71px");e("#pdf_dropdown").hide();r=!1}});e("#getting_started_guide").unbind("click").bind("click",function(){if(r===!1){e("#pdf_dropdown").fadeIn("fast");r=!0}else{e("#pdf_dropdown").hide();r=!1}});e("#home_login").unbind("submit").bind("submit",function(){n();var t={username:"",password:""},r=e("#home_login_submit");e(r).css("cursor","auto");e(r).css("background","#004e84");e(r).css("font-size","13px");e(r).text("logging...");e(r).attr("disabled","true");var i=window.location.pathname,s=window.location.href.split("?"),o=s[1];t.username=e("#home_login_email").val();t.password=e("#home_login_password").val();WHOAT.networking.postToServerWithAjax("/login",t,function(t){if(t.result==="success"){e("#home_login_email").css("border","2px solid #E8E8E8");e("#home_login_password").css("border","2px solid #E8E8E8");WHOAT.networking.redirectToURL("/dashboard")}else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).css("font-size","16px");e(r).text("login");e(r).css("background","#006497");e(r).css("cursor","pointer");var n=t.message;if(n==="Username not registered"){e(".error_home_username span").text(n);e(".error_home_username").show()}else if(n==="Invalid password"){e(".error_home_password span").text(n);e(".error_home_password").show()}else{e(".error_home_username span").text(n);e(".error_home_username").show()}}});return!1});e(".close_errs").unbind("click").bind("click",function(){n()});e(".home_login_input").focus(function(){n()});e(".learn_more").unbind("click").bind("click",function(){WHOAT.analytics.trackClickEvent("Learn More");e("html, body").animate({scrollTop:e("#intro_app_area").offset().top},1e3)});e(".go_appstore").unbind("click").bind("click",function(){var t=e(this),n=t.data("id");WHOAT.analytics.trackClickEvent("iPhone App Store");WHOAT.networking.redirectToURL("https://itunes.apple.com/us/app/who-intro/id"+n,"_blank")});e(".arrow_to_namegame").unbind("click").bind("click",function(){e("html, body").animate({scrollTop:e("#namegame_area").offset().top},1e3)});var i=e(".see_it_works");i.length&&i.modal&&i.modal({trigger:".see_it_works",olay:"div.overlay",modals:"div.video_holder",animationEffect:"fadeIn",animationSpeed:400,moveModalSpeed:"slow",background:"000",opacity:.8,openOnLoad:!1,docClose:!0,closeByEscape:!0,moveOnScroll:!0,resizeWindow:!0,video:"https://player.vimeo.com/video/84403777?autoplay=1",videoClass:"video",close:".big_x"})},u=function(t){e(".login_unselected").unbind("click").bind("click",function(){r("login")});e(".register_unselected").unbind("click").bind("click",function(){r("register")});var r=function(t){if(t==="register"){e("#login_form").hide();e("#register_form").show();e(".on_login_tab").hide();e(".on_register_tab").show()}else if(t==="login"){e("#register_form").hide();e("#login_form").show();e(".on_login_tab").show();e(".on_register_tab").hide()}};r(t);e("#login_form").unbind("submit").bind("submit",function(){var t={username:"",password:""},r=e("#login_page_submit");e(r).css("cursor","auto");e(r).css("background","#ccc");e(r).text("logging...");e(r).attr("disabled","true");var i=window.location.href.split("?"),s=i[1];if(s!==n&&s.toLowerCase().indexOf("bounce=")>=0){s=s.replace("bounce=","");t.bounce=s}t.username=e("#login_input_email").val();t.password=e("#login_input_password").val();WHOAT.networking.postToServerWithAjax("/login",t,function(t){if(t.result==="success")WHOAT.networking.redirectToURL("/dashboard");else if(t.result==="bounce")WHOAT.networking.redirectToURL(t.message);else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).text("login");e(r).css("background","#f58733");e(r).css("cursor","pointer");var n=t.message;if(n!=="Username not registered")if(n==="Invalid password"){e(".error_password_span").text(n);e("#error_login_password").show()}else{e(".error_email_span").text(n);e("#error_login_email").show()}}});return!1});e("#register_form").unbind("submit").bind("submit",function(t){WHOAT.validation.validateRegisterForm("#register_form");var r=e("#the_register_button");e(r).css("cursor","auto");e(r).css("background","#ccc");e(r).text("registering...");e(r).attr("disabled","true");var i={username:"",firstName:"",lastName:"",password:"",register_source:"",register_original:""};i.username=e("#register_email").val();i.firstName=e("#register_firstname"
).val();i.lastName=e("#register_lastname").val();i.password=e("#register_password").val();i.register_original=e("#register_original").val();i.register_source=e("#register_source").val();WHOAT.networking.postToServerWithAjax("/register",i,function(t){if(t.result==="success"){e(r).text("register");e(r).css("background","#f58733");i.register_original===n||i.register_original===""?window.location="/register/success":window.location="/auto/verify"}else if(t.result==="error"){e(r).text("register");e(r).removeAttr("disabled");e(r).css("background","#f58733");e(r).css("cursor","pointer");e("#register_input_error").fadeIn("fast",function(){var n=!0,r=e("#register_input_error");e("#input_error_message").text(t.message);r.show();r.click(function(){e("#register_input_error").hide();n=!1});n&&setTimeout(function(){e(this).fadeOut("slow",function(){n=!1})},5e3)})}});return!1});e(".x").unbind("click").bind("click",function(){var t=e(this),n=t.parent("div").attr("id");t.parent("div").hide();n==="error_login_email"?e("#login_input_email").css("border","2px solid #E8E8E8"):n==="error_login_password"&&e("#password").css("border","2px solid #E8E8E8")})},a=function(){e(".whoat_logo").unbind("click").bind("click",function(){WHOAT.networking.redirectToURL("/home")});e("#faq_page .open_guides").unbind("click").bind("click",function(){e("#faq_page").animate({scrollTop:e("#header").offset().top},500);e(".pdf_menu").css("left","79px");e("#pdf_dropdown").fadeIn("fast");r=!0})};return{init:i,wireHomePage:o,wireLoginRegister:u,wireFAQ:a}}(jQuery,window);$(document).ready(function(){WHOAT.web.init()});
WHOAT.modal=function(e,t,n){"use strict";var r=function(){},i=function(){var t=function(){function a(t){t==="closed"&&e(".overlay").hide();e("#tour_modal").hide();e('[id^="tour_"]').stop(!0,!0);i=function(){}}var t=1,n=0,r=function(t){e("#tour_modal").find("section").fadeOut();t===1?e("#tour_1").fadeIn():t===2?e("#tour_2").fadeIn():t===3?e("#tour_3").fadeIn():t===4&&e("#tour_4").fadeIn()},i=function(){e(".overlay").show();e("#tour_modal").fadeIn("fast");e("#tour_1").delay(7e3).fadeOut("fast",function(){t=2;e("#tour_prev").css({opacity:1});e("#tour_btn_1").children().removeClass("tour_nav_blue");e("#tour_btn_1").children().addClass("tour_nav_white");e("#tour_btn_2").children().removeClass("tour_nav_white");e("#tour_btn_2").children().addClass("tour_nav_blue");e("#tour_2").fadeIn("fade").delay(7e3).fadeOut("fast",function(){t=3;e("#tour_next").empty();e("#tour_next").append("next");e("#tour_btn_2").children().removeClass("tour_nav_blue");e("#tour_btn_2").children().addClass("tour_nav_white");e("#tour_btn_3").children().removeClass("tour_nav_white");e("#tour_btn_3").children().addClass("tour_nav_blue");e("#tour_3").fadeIn("fade").delay(7e3).fadeOut("fast",function(){t=4;e("#tour_next").text("Continue");e("#tour_btn_3").children().removeClass("tour_nav_blue");e("#tour_btn_3").children().addClass("tour_nav_white");e("#tour_btn_4").children().removeClass("tour_nav_white");e("#tour_btn_4").children().addClass("tour_nav_blue");e("#tour_4").fadeIn("fade").delay(8e3).fadeOut("fast",function(){a();s().startSyncModal()})})})})},o=function(n,i){t=n;if(n===1){e(".tour_prev").css({opacity:.5});e(".tour_next").empty();e(".tour_next").append("next >");r(1);u("#tour_btn_1")}else if(n===2){e(".tour_prev").css({opacity:1});e(".tour_next").empty();e(".tour_next").append("next >");r(2);u("#tour_btn_2")}else if(n===3){e(".tour_prev").css({opacity:1});e(".tour_next").empty();e(".tour_next").append("next >");r(3);u("#tour_btn_3")}else if(n===4){e(".tour_prev").css({opacity:1});e(".tour_next").text("continue");r(4);u("#tour_btn_4")}else if(n===5){a();s().startSyncModal()}},u=function(t){e('[id^="tour_"]').stop(!0,!0);i=function(){};var n=e(t);n.children().removeClass("tour_nav_white");n.children().addClass("tour_nav_blue");n.siblings("li").children().removeClass("tour_nav_blue");n.siblings("li").children().addClass("tour_nav_white")};e(".tour_nav_circle").unbind("click").bind("click",function(t){e('[id^="tour_"]').stop(!0,!0);i=function(){};var r=this.id;switch(r){case"tour_btn_1":n=1;break;case"tour_btn_2":n=2;break;case"tour_btn_3":n=3;break;case"tour_btn_4":n=4}o(n,"dot")});e(".tour_prev").unbind("click").bind("click",function(r){e('[id^="tour_"]').stop(!0,!0);i=function(){};n=t-1;o(n,"prev")});e(".tour_next").unbind("click").bind("click",function(r){e('[id^="tour_"]').stop(!0,!0);i=function(){};n=t+1;o(n,"next")});e(".close_tour").on("click",function(e){a();s().startSyncModal()});e(".overlay").unbind("click").bind("click",function(){a();s().startSyncModal()});i()},n=function(){e("#tour_next").text("next >");e("#tour_modal").find("section").fadeOut();e("#tour_modal").css("top","18%");e("#tour_1").fadeIn();var t=e("#tour_btn_1");t.children().attr("src","/assets/img/dashboard/tour_nav_blue.gif");t.siblings("li").children("img").attr("src","/assets/img/dashboard/tour_nav_white.gif")};return{startTour:t,tourReset:n}},s=function(){var t=function(){e("#sync_modal").show();e("#sync_email_choices").show();e(".rewatch_tour").unbind("click").bind("click",function(){e("#sync_modal").hide();e("#sync_email_choices").hide();i().tourReset();e("#tour_modal").show()});e(".choose_exchange_gmail").unbind("click").bind("click",function(){e("#sync_email_choices").show();e("#sync_exchange_snarf").hide();e("#exchange_inputs").hide()});e("#btn_sync_exchange").unbind("click").bind("click",function(){e("#sync_email_choices").hide();e("#sync_exchange_snarf").show();e("#exchange_inputs").show()});e("#exchange-simple-form").unbind("submit").bind("submit",function(){WHOAT.dashboard.hideKeyboard(e());var t=e("#sync_exchange_email").val(),n=e("#sync_exchange_password").val(),r={email:t,password:n},i=e("#exchange_simple_btn");e(i).css("cursor","auto");e(i).css("background","#ccc");e(i).text("sync started");e(i).attr("disabled","true");e("#patience_modal").show();e("#sync_exchange_snarf").hide();e("#exchange_inputs").hide();WHOAT.notify.notification().showStatus("Please be patient, this may take a few minutes");WHOAT.networking.postToServerWithAjax("/sync_contacts",r,function(t){console.log(t);e(".notification_container").fadeOut("fast",function(){e(".notification_container").empty()});e(i).text("sync contacts");e(i).removeAttr("disabled");e(i).css("cursor","pointer");e(i).css("background","#f58733");if(t.result==="success"){e(".overlay").hide();e("#patience_modal").hide();e("#sync_modal").hide();e("#widget_msg p").text(t.message);e("#widget_msg").fadeIn("fast")}else if(t.result==="error"){e("#patience_modal").hide();e("#sync_exchange_snarf").show();e("#exchange_inputs_advanced").show();WHOAT.notify.notification().setStatusAndFadeStatus(t.message)}});return!1});e(".close_tour").on("click",function(t){e("#sync_modal").hide();e(".overlay").hide()});e(".overlay").unbind("click").bind("click",function(){e("#sync_modal").hide();e(".overlay").hide()});e(".close_widget_msg").on("click",function(t){e("#widget_msg").hide();e("#widget_msg").empty()})};return{startSyncModal:t}};return{wireTourModal:i,wireSyncModal:s,init:r}}(jQuery,window);$(document).ready(function(){WHOAT.modal.init()});